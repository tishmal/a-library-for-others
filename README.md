# Библиотека CSV Parser на Go

Этот репозиторий содержит простую библиотеку для парсинга CSV-файлов, написанную на языке Go. Она предоставляет функциональность для построчного чтения и парсинга CSV-файлов, извлечения полей из строки и определения количества полей в каждой строке. Также библиотека обрабатывает распространенные ошибки, такие как несоответствие кавычек или некорректное количество полей в CSV-файле.

## Возможности

- **ReadLine**: Читает одну строку из CSV-файла, обрабатывая различные типы завершений строк (`\r`, `\n`, `\r\n`).
- **GetField**: Извлекает n-е поле из последней прочитанной строки.
- **GetNumberOfFields**: Возвращает количество полей в последней прочитанной строке.
- **Обработка ошибок**: Обрабатывает распространенные ошибки парсинга CSV, такие как лишние или отсутствующие кавычки в полях и неправильное количество полей.

## Установка

Чтобы использовать библиотеку CSV Parser, клонируйте этот репозиторий и импортируйте его в ваш проект на Go:

```bash
git clone https://github.com/yourusername/csvparser.git
Затем импортируйте библиотеку в ваш Go-код:

go
Copy code
import "path/to/csvparser"
Использование
Пример того, как можно использовать библиотеку CSV Parser для чтения строк из CSV-файла и обработки полей.

Пример
go
Copy code
package main

import (
	"fmt"
	"os"
	"path/to/csvparser"
	"io"
)

func main() {
	// Открытие CSV-файла
	file, err := os.Open("example.csv")
	if err != nil {
		fmt.Println("Ошибка при открытии файла:", err)
		return
	}
	defer file.Close()

	// Создание нового экземпляра CSVParser
	var csvparser csvparser.CSVParser = csvparser.NewCSVParser()

	// Чтение и обработка каждой строки CSV-файла
	for {
		line, err := csvparser.ReadLine(file)
		if err != nil {
			if err == io.EOF {
				break
			}
			fmt.Println("Ошибка при чтении строки:", err)
			return
		}

		// Вывод прочитанной строки
		fmt.Println("Прочитана строка:", line)

		// Получение количества полей в строке
		numFields := csvparser.GetNumberOfFields()
		fmt.Println("Количество полей:", numFields)

		// Извлечение каждого поля по индексу
		for i := 0; i < numFields; i++ {
			field, err := csvparser.GetField(i)
			if err != nil {
				fmt.Println("Ошибка при получении поля:", err)
				return
			}
			fmt.Printf("Поле %d: %s\n", i, field)
		}
	}
}
Функции
ReadLine(r io.Reader) (string, error)
Эта функция читает одну строку из входного CSV-файла.

Параметры: r — объект типа io.Reader (например, файл), из которого будет читаться строка.
Возвращает: Строку, представляющую прочитанную строку без символов новой строки. Если произошла ошибка (например, несоответствие кавычек), возвращается пустая строка и ошибка.
Ошибки:
ErrQuote: Если в строке отсутствуют или лишние кавычки.
io.EOF: Если достигнут конец файла.
GetField(n int) (string, error)
Эта функция извлекает n-е поле из последней прочитанной строки.

Параметры: n — индекс поля для извлечения (нумерация с 0).
Возвращает: Строку, представляющую значение поля.
Ошибки:
ErrFieldCount: Если индекс n выходит за пределы (отрицательный или больше, чем количество полей в текущей строке).
GetNumberOfFields() int
Эта функция возвращает количество полей в последней прочитанной строке.

Возвращает: Количество полей как целое число.
Поведение: Этот метод не должен быть вызван до того, как будет вызвана функция ReadLine.
Обработка ошибок
Библиотека использует следующие типы ошибок:

ErrQuote: Возникает, если в строке обнаружены лишние или отсутствующие кавычки вокруг поля.
ErrFieldCount: Возникает, если количество полей в текущей строке не соответствует ожидаемому.
Пример CSV-файла
Пример CSV-файла example.csv, который можно использовать для тестирования библиотеки:

arduino
Copy code
Name, Age, City
"John, Doe", 30, "New York"
"Jane, Smith", 25, "Los Angeles"
"Jack, Brown", 40, "Chicago"
Тестирование
Библиотека разработана с учетом различных крайних случаев парсинга CSV. Вот несколько вещей, которые стоит протестировать:

Файлы с отсутствующими или лишними кавычками вокруг полей.
Файлы с различными типами завершений строк (\n, \r\n, \r).
Файлы с разным количеством полей в строках.
Файлы с бинарными данными или неверным содержимым CSV.
Лицензия
Этот проект лицензирован на условиях лицензии MIT.